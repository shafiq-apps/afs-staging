"use strict";var p={enabled:!0,error:(e,t)=>{p.enabled&&console.error("[AFS]",e,t||"")},warn:(e,t)=>{p.enabled&&console.warn("[AFS]",e,t||"")},info:(e,t)=>{p.enabled&&console.info("[AFS]",e,t||"")},debug:(e,t)=>{p.enabled&&console.debug("[AFS]",e,t||"")},log:(e,...t)=>{p.enabled&&console.log(e,...t)},init:e=>{p.enabled=e!==!1,p.log("%cAdvanced Filter & Search initialized","color: #00c853;font-size: 20px;font-weight: bold;background: #0b1e13;padding: 10px 15px;border-radius: 6px;font-family: Arial, sans-serif;")}};var S={buttons:{quickAdd:"Quick Add",quickAddToCart:"Quick add to cart",quickView:"Quick view",addToCart:"Add to cart",soldOut:"Sold out",buyNow:"Buy it now",clear:"Clear",clearAll:"Clear All",close:"\u2715",closeFilters:"Close filters",toggleFilters:"Filters",filters:"Filters",previous:"Previous",next:"Next",apply:"Apply"},labels:{sortBy:"Sort by: ",appliedFilters:"Applied Filters:",search:"Search: ",price:"Price: ",collection:"Collection: ",productUnavailable:"Product unavailable",loading:"Loading...",loadingProduct:"Loading product..."},sortOptions:{bestSelling:"Best Selling",titleAsc:"Title (A-Z)",titleDesc:"Title (Z-A)",priceAsc:"Price (Low to High)",priceDesc:"Price (High to Low)",createdAsc:"Oldest First",createdDesc:"Newest First"},messages:{noProductsFound:"No products found",oneProductFound:"1 product found",productsFound:"products found",showingProducts:"Showing",pageOf:"Page",addedToCart:"Added to cart!",failedToLoad:"Failed to load",failedToLoadProducts:"Failed to load products",failedToLoadProduct:"Failed to load product",failedToAddToCart:"Failed to add product to cart. Please try again.",failedToProceedToCheckout:"Failed to proceed to checkout. Please try again.",failedToLoadProductModal:"Failed to load product. Please try again.",failedToLoadFilters:"Failed to load filters, continuing with empty filters",initializationFailed:"Initialization failed",loadFailed:"Load failed",unknownError:"Unknown error",checkConsole:"Check console for details."},placeholders:{searchProducts:"Search products...",searchFilter:"Search"}};var s={debounce:(e,t)=>{let r;return(...o)=>{r!==void 0&&clearTimeout(r),r=setTimeout(()=>e(...o),t)}},toLowerCase:e=>String(e||"").toLowerCase(),inputDisplayType:e=>s.equalsAny(s.toLowerCase(e==null?void 0:e.displayType),"radio")?"radio":"checkbox",isMultiSelect:e=>s.equalsAny(s.toLowerCase(e==null?void 0:e.selectionType),"multiple")||s.equalsAny(e==null?void 0:e.selectionType,"MULTIPLE"),split:e=>e?Array.isArray(e)?e.map(t=>String(t).trim()).filter(Boolean):String(e).split(",").map(t=>t.trim()).filter(Boolean):[],id:e=>{if(!e)return null;let t=e.productId||e.id||e.gid;return t&&String(t).split("/").pop()||null},str:e=>String(e||"").trim(),empty:e=>e?Array.isArray(e)?e.length===0:typeof e=="object"?Object.keys(e).length===0:!1:!0,el:(e,t,r={})=>{let o=document.createElement(e);return t&&(o.className=t),Object.entries(r).forEach(([i,a])=>o.setAttribute(i,a)),o},txt:(e,t)=>(e.textContent=t,e),clear:e=>{for(;e.firstChild;){let t=e.firstChild;t&&e.removeChild(t)}},frag:(e,t)=>{let r=document.createDocumentFragment();return e.forEach(o=>r.appendChild(t(o))),r},optimizeImageUrl:(e,t={})=>{if(!e||typeof e!="string")return"";let{width:r=500,height:o=r,quality:i=80,format:a="webp",crop:d=null}=t;if(!/(cdn\.shopify\.com|shopifycdn\.com)/i.test(e))return e;try{let c=new URL(e),l=new URLSearchParams(c.search);return l.delete("width"),l.delete("height"),l.delete("crop"),l.delete("format"),l.delete("quality"),l.set("width",String(r)),l.set("height",String(o)),d&&l.set("crop",d),i!==100&&l.set("quality",String(i)),!c.pathname.toLowerCase().endsWith(".gif")&&a&&l.set("format",a),`${c.origin}${c.pathname}?${l.toString()}`}catch(c){return e}},buildImageSrcset:(e,t=[200,300,500])=>e?t.map(r=>`${s.optimizeImageUrl(e,{width:r,format:"webp",quality:r<=200?75:r<=300?80:85})} ${r}w`).join(", "):"",formatMoney:(e,t,r="")=>{if(isNaN(Number(e)))return"";let o=parseFloat(String(e))/100;if(!t||typeof t!="string")return`${r||""}${o.toFixed(2)}`;let i=o.toFixed(2);return t.includes("{{amount_no_decimals}}")?(i=Math.round(o).toString(),t.replace("{{amount_no_decimals}}",i)):t.includes("{{amount_with_comma_separator}}")?(i=o.toFixed(2).replace(".",","),t.replace("{{amount_with_comma_separator}}",i)):t.includes("{{amount_no_decimals_with_comma_separator}}")?(i=Math.round(o).toString(),t.replace("{{amount_no_decimals_with_comma_separator}}",i)):t.includes("{{amount_with_apostrophe_separator}}")?(i=o.toFixed(2).replace(".","'"),t.replace("{{amount_with_apostrophe_separator}}",i)):t.replace("{{amount}}",i)},equals:(e,t)=>e===t?!0:e==null||t===null||t===void 0?!1:(Array.isArray(e)&&(e=e.join(",")),Array.isArray(t)&&(t=t.join(",")),typeof e=="string"&&typeof t=="string"?e.trim().toLowerCase()===t.trim().toLowerCase():typeof e=="number"&&typeof t=="number"||typeof e=="boolean"&&typeof t=="boolean"?e===t:String(e).trim().toLowerCase()===String(t).trim().toLowerCase()),equalsAny:(e,...t)=>e==null?!1:t.some(r=>s.equals(e,r)),isVendorKey:e=>s.equalsAny(e,"vendor","vendors"),isProductTypeKey:e=>s.equalsAny(e,"productType","productTypes"),isTagKey:e=>s.equalsAny(e,"tag","tags"),isCollectionKey:e=>s.equalsAny(e,"collection","collections"),isPriceRangeKey:e=>s.equalsAny(e,"priceRange","price"),isBestSelling:e=>s.equalsAny(e,"best-selling","bestselling"),isCollectionOptionType:e=>s.equals(e,"Collection"),isPriceRangeOptionType:e=>s.equals(e,"priceRange")};var b={apiBaseUrl:"https://fstaging.digitalcoo.com/storefront",shop:null,moneyFormat:null,currency:null,moneyWithCurrencyFormat:null,searchInputSelector:'input[name="q"], input[name="search"], input[type="search"][name*="q"], input[type="search"][name*="search"], .search__input, form[action*="/search"] input[type="search"], form[action*="/search"] input[name*="q"]',minQueryLength:2,debounceMs:300,maxSuggestions:5,maxProducts:6,showSuggestions:!0,showProducts:!0,enableKeyboardNav:!0,debug:!1},n={config:b,activeInput:null,dropdown:null,container:null,currentQuery:"",isOpen:!1,selectedIndex:-1,searchResults:null,isLoading:!1,abortController:null,replacedInputs:new Set,inputContainers:new Map,overriddenContainers:new Set,searchButtons:new Set,customSearchBox:null,visibilityObserver:null,observedInputs:new Set},g={createContainer(e){let t=s.el("div","afs-search-container");t.style.position="absolute",t.style.display="block";let r=e.getBoundingClientRect(),o=r.width,i=280,a=o<i?i:o,d=window.pageYOffset||document.documentElement.scrollTop,u=window.pageXOffset||document.documentElement.scrollLeft;return t.style.top=`${r.bottom+d}px`,t.style.left=`${r.left+u}px`,t.style.width=`${a}px`,t.style.minWidth=`${i}px`,t.style.zIndex="999999",t},createDropdown(){let e=s.el("div","afs-search-dropdown");return e.setAttribute("role","listbox"),e.setAttribute("aria-label","Search results"),e},setupInputContainer(e){if(n.inputContainers.has(e)){let i=n.inputContainers.get(e);return this.updateContainerPosition(e,i),i}let t=this.createContainer(e);document.body.appendChild(t);let r=this.createDropdown();return t.appendChild(r),n.inputContainers.set(e,t),new ResizeObserver(()=>{this.updateContainerPosition(e,t),n.isOpen&&n.activeInput===e&&this.positionDropdown(e)}).observe(e),t},updateContainerPosition(e,t){let r=e.getBoundingClientRect(),o=r.width,i=280,a=o<i?i:o,d=window.pageYOffset||document.documentElement.scrollTop,u=window.pageXOffset||document.documentElement.scrollLeft;t.style.top=`${r.bottom+d}px`,t.style.left=`${r.left+u}px`,t.style.width=`${a}px`,t.style.minWidth=`${i}px`},createSuggestionItem(e,t){let r=s.el("div","afs-search-dropdown__suggestion",{role:"option","data-index":String(t),tabindex:"-1"}),o=s.el("span","afs-search-dropdown__suggestion-icon");o.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.35-4.35"/></svg>';let i=s.el("span","afs-search-dropdown__suggestion-text");return i.textContent=e,r.appendChild(o),r.appendChild(i),r},createProductItem(e,t){var u,c;let r=e.handle||"",o=r?`/products/${r}`:"#",i=s.el("a","afs-search-dropdown__product",{href:o,role:"option","data-index":String(t),"data-handle":r,tabindex:"-1"});if(r||i.addEventListener("click",l=>{l.preventDefault(),p.warn("Product item clicked but no handle available",{product:e})}),e.imageUrl||e.featuredImage){let l=s.el("div","afs-search-dropdown__product-image"),h=s.el("img","",{alt:e.title||"",loading:"lazy",decoding:"async"}),m=((u=e.featuredImage)==null?void 0:u.url)||((c=e.featuredImage)==null?void 0:c.urlFallback)||e.imageUrl||"";m&&(h.src=m),l.appendChild(h),i.appendChild(l)}let a=s.el("div","afs-search-dropdown__product-info"),d=s.el("div","afs-search-dropdown__product-title");if(d.textContent=e.title||"",a.appendChild(d),e.vendor){let l=s.el("div","afs-search-dropdown__product-vendor");l.textContent=e.vendor,a.appendChild(l)}if(e.minPrice!==void 0){let l=s.el("div","afs-search-dropdown__product-price"),h=parseFloat(String(e.minPrice||0))*100,m=parseFloat(String(e.maxPrice||0))*100,v=n.config.moneyFormat||"{{amount}}",I=n.config.currency||"",T=s.formatMoney(h,v,I),C=h===m?T:`from ${T}`;l.textContent=C,a.appendChild(l)}return i.appendChild(a),i},createDidYouMeanItem(e){let t=s.el("div","afs-search-dropdown__did-you-mean",{role:"option","data-type":"did-you-mean",tabindex:"-1"}),r=s.el("span","afs-search-dropdown__did-you-mean-text");return r.innerHTML=`Did you mean <strong>${e}</strong>?`,t.appendChild(r),t},createEmptyState(e){let t=s.el("div","afs-search-dropdown__empty",{role:"option"});return t.textContent=e,t},createLoadingState(){let e=s.el("div","afs-search-dropdown__loading",{role:"option"});return e.innerHTML=`
			<div class="afs-search-dropdown__loading-spinner"></div>
			<span>${S.labels.loading}</span>
		`,e},renderDropdown(e,t,r=!1){var a;if(!n.dropdown)return;if(n.dropdown.innerHTML="",n.selectedIndex=-1,n.isLoading){n.dropdown.appendChild(this.createLoadingState());return}if(!t&&r){let d=this.createEmptyState("Start typing to search...");n.dropdown.appendChild(d);return}if(!e)return;let o=document.createDocumentFragment(),i=0;if(e.didYouMean&&e.zeroResults){let d=this.createDidYouMeanItem(e.didYouMean);d.setAttribute("data-index",String(i)),o.appendChild(d),i++}if(n.config.showSuggestions&&e.suggestions&&e.suggestions.length>0){let d=s.el("div","afs-search-dropdown__header");d.textContent="Suggestions",o.appendChild(d),e.suggestions.slice(0,n.config.maxSuggestions).forEach(u=>{let c=this.createSuggestionItem(u,i);o.appendChild(c),i++})}if(n.config.showProducts&&e.products&&e.products.length>0){let d=s.el("div","afs-search-dropdown__header");if(d.textContent=`Products (${((a=e.pagination)==null?void 0:a.total)||e.products.length})`,o.appendChild(d),e.products.slice(0,n.config.maxProducts).forEach(u=>{let c=this.createProductItem(u,i);o.appendChild(c),i++}),e.pagination&&e.pagination.total>n.config.maxProducts){let u=s.el("a","afs-search-dropdown__view-all",{href:`/search?q=${encodeURIComponent(t)}`,role:"option"});u.textContent=`View all ${e.pagination.total} results`,u.setAttribute("data-index",String(i)),o.appendChild(u),i++}}e.zeroResults&&(!e.suggestions||e.suggestions.length===0)&&(!e.products||e.products.length===0)&&o.appendChild(this.createEmptyState("No products found. Try adjusting your search terms.")),n.dropdown.appendChild(o)},positionDropdown(e){!n.dropdown||!n.container||(this.updateContainerPosition(e,n.container),n.dropdown.style.position="absolute",n.dropdown.style.top="100%",n.dropdown.style.left="0",n.dropdown.style.width="100%",n.dropdown.style.maxHeight="400px",n.dropdown.style.overflowY="auto",n.dropdown.style.zIndex="999999",n.dropdown.style.marginTop="4px")},showDropdown(){!n.dropdown||!n.activeInput||(n.container||(n.container=this.setupInputContainer(n.activeInput),n.dropdown=n.container.querySelector(".afs-search-dropdown"),n.dropdown||(n.dropdown=this.createDropdown(),n.container.appendChild(n.dropdown))),n.isOpen=!0,n.dropdown.classList.add("afs-search-dropdown--visible"),n.dropdown.setAttribute("aria-expanded","true"),this.positionDropdown(n.activeInput))},hideDropdown(){n.dropdown&&(n.isOpen=!1,n.selectedIndex=-1,n.dropdown.classList.remove("afs-search-dropdown--visible"),n.dropdown.setAttribute("aria-expanded","false"))},highlightItem(e){if(!n.dropdown)return;n.dropdown.querySelectorAll('[role="option"][data-index]').forEach((r,o)=>{o===e?(r.classList.add("afs-search-dropdown__item--selected"),r.scrollIntoView({block:"nearest",behavior:"smooth"})):r.classList.remove("afs-search-dropdown__item--selected")}),n.selectedIndex=e},getSelectedItem(){return!n.dropdown||n.selectedIndex<0?null:n.dropdown.querySelectorAll('[role="option"][data-index]')[n.selectedIndex]||null}},x={async search(e){let t=n.config.shop,r=n.config.apiBaseUrl;if(!t||!r)return p.error("Search API: shop or apiBaseUrl not configured",{hasShop:!!t,hasApiBaseUrl:!!r}),null;n.abortController&&n.abortController.abort(),n.abortController=new AbortController;let o=new URLSearchParams;o.set("shop",t),o.set("q",e),o.set("suggestions","true"),o.set("autocomplete","true"),o.set("limit",String(n.config.maxProducts));let i=`${r}/search?${o}`;try{n.isLoading=!0,g.renderDropdown(null,e);let a=await fetch(i,{signal:n.abortController.signal,headers:{Accept:"application/json"}});if(!a.ok)throw new Error(`HTTP ${a.status}: ${a.statusText}`);let d=await a.json();return!d.success||!d.data?(p.error("Invalid search response",{data:d}),null):d.data}catch(a){return a.name==="AbortError"?(p.debug("Search request aborted"),null):(p.error("Search API error",{error:a.message,query:e}),null)}finally{n.isLoading=!1}}},f={debouncedSearch:s.debounce(async e=>{if(e.length<n.config.minQueryLength){n.searchResults=null,g.hideDropdown();return}n.activeInput&&!n.inputContainers.has(n.activeInput)&&y.replaceInput(n.activeInput),n.currentQuery=e;let t=await x.search(e);n.searchResults=t,t!==null?(g.renderDropdown(t,e),g.showDropdown()):g.hideDropdown()},b.debounceMs),handleInput(e){let t=e.target,r=t.value.trim();n.activeInput=t,f.debouncedSearch(r)},handleFocus(e){let t=e.target;n.activeInput=t,n.inputContainers.has(t)?(n.container=n.inputContainers.get(t),n.dropdown=n.container.querySelector(".afs-search-dropdown")):y.replaceInput(t);let r=t.value.trim();r.length>=n.config.minQueryLength&&n.searchResults?(g.renderDropdown(n.searchResults,r),g.showDropdown()):r.length>0?f.debouncedSearch(r):(g.renderDropdown(null,"",!0),g.showDropdown())},handleBlur(e){setTimeout(()=>{var t,r;!((t=n.dropdown)!=null&&t.matches(":hover"))&&!((r=n.activeInput)!=null&&r.matches(":focus"))&&g.hideDropdown()},200)},handleKeyDown(e){var o,i,a,d;if(!n.isOpen||!n.dropdown)return;let r=n.dropdown.querySelectorAll('[role="option"][data-index]').length;switch(e.key){case"ArrowDown":e.preventDefault(),n.selectedIndex=Math.min(n.selectedIndex+1,r-1),g.highlightItem(n.selectedIndex);break;case"ArrowUp":e.preventDefault(),n.selectedIndex=Math.max(n.selectedIndex-1,-1),n.selectedIndex>=0?g.highlightItem(n.selectedIndex):(o=n.activeInput)==null||o.focus();break;case"Enter":e.preventDefault();let u=g.getSelectedItem();if(u)if(u.tagName==="A")window.location.href=u.href;else if(u.getAttribute("data-type")==="did-you-mean"){let c=(i=n.searchResults)==null?void 0:i.didYouMean;c&&n.activeInput&&(n.activeInput.value=c,f.debouncedSearch(c))}else{let c=(a=u.querySelector(".afs-search-dropdown__suggestion-text"))==null?void 0:a.textContent;c&&n.activeInput&&(n.activeInput.value=c,f.debouncedSearch(c))}else if(n.activeInput){let c=n.activeInput.value.trim();c&&(window.location.href=`/search?q=${encodeURIComponent(c)}`)}break;case"Escape":e.preventDefault(),g.hideDropdown(),(d=n.activeInput)==null||d.blur();break}},handleClick(e){var o,i;let r=e.target.closest('[role="option"]');if(r){if(r.tagName==="A")if(r.getAttribute("data-handle")){g.hideDropdown(),n.customSearchBox&&y.hideCustomSearchBox();return}else{e.preventDefault(),p.warn("Product link clicked but no handle available");return}if(e.preventDefault(),r.getAttribute("data-type")==="did-you-mean"){let a=(o=n.searchResults)==null?void 0:o.didYouMean;a&&n.activeInput&&(n.activeInput.value=a,f.debouncedSearch(a))}else{let a=(i=r.querySelector(".afs-search-dropdown__suggestion-text"))==null?void 0:i.textContent;a&&n.activeInput&&(n.activeInput.value=a,f.debouncedSearch(a))}}}},y={readConfigFromDataAttributes(){let e=document.querySelector("[data-afs-search-container]");if(!e)return null;let t={};if(e.dataset.afsSearchShop&&(t.shop=e.dataset.afsSearchShop),e.dataset.afsSearchApiBaseUrl&&(t.apiBaseUrl=e.dataset.afsSearchApiBaseUrl),e.dataset.afsSearchMoneyFormat&&(t.moneyFormat=e.dataset.afsSearchMoneyFormat),e.dataset.afsSearchCurrency&&(t.currency=e.dataset.afsSearchCurrency),e.dataset.afsSearchMoneyWithCurrencyFormat&&(t.moneyWithCurrencyFormat=e.dataset.afsSearchMoneyWithCurrencyFormat),e.dataset.afsSearchDebug!==void 0){let r=e.dataset.afsSearchDebug;t.debug=r==="true"||r==="1"}if(e.dataset.afsSearchMinQueryLength){let r=parseInt(e.dataset.afsSearchMinQueryLength,10);!isNaN(r)&&r>0&&(t.minQueryLength=r)}if(e.dataset.afsSearchDebounceMs){let r=parseInt(e.dataset.afsSearchDebounceMs,10);!isNaN(r)&&r>=0&&(t.debounceMs=r)}if(e.dataset.afsSearchMaxSuggestions){let r=parseInt(e.dataset.afsSearchMaxSuggestions,10);!isNaN(r)&&r>0&&(t.maxSuggestions=r)}if(e.dataset.afsSearchMaxProducts){let r=parseInt(e.dataset.afsSearchMaxProducts,10);!isNaN(r)&&r>0&&(t.maxProducts=r)}if(e.dataset.afsSearchShowSuggestions!==void 0){let r=e.dataset.afsSearchShowSuggestions;t.showSuggestions=r==="true"||r==="1"}if(e.dataset.afsSearchShowProducts!==void 0){let r=e.dataset.afsSearchShowProducts;t.showProducts=r==="true"||r==="1"}if(e.dataset.afsSearchEnableKeyboardNav!==void 0){let r=e.dataset.afsSearchEnableKeyboardNav;t.enableKeyboardNav=r==="true"||r==="1"}return e.dataset.afsSearchInputSelector&&(t.searchInputSelector=e.dataset.afsSearchInputSelector),Object.keys(t).length>0?t:null},createCustomSearchBox(){if(n.customSearchBox)return n.customSearchBox;let e=s.el("div","afs-search-override-box");e.style.cssText=`
			position: fixed;
			top: 0;
			left: 0;
			right: 0;
			background: var(--afs-bg-color, #fff);
			border-bottom: 1px solid var(--afs-border-color, #e0e0e0);
			z-index: 999998;
			padding: 16px;
			box-shadow: 0 2px 8px rgba(0,0,0,0.1);
			display: none;
		`;let t=s.el("form","afs-search-override-form");t.style.cssText=`
			display: flex;
			align-items: center;
			gap: 12px;
			max-width: 1200px;
			margin: 0 auto;
		`;let r=s.el("input","afs-search-override-input");r.type="search",r.name="q",r.placeholder="Search products...",r.autocomplete="off",r.style.cssText=`
			flex: 1;
			padding: 12px 16px;
			border: 1px solid var(--afs-border-color, #e0e0e0);
			border-radius: 4px;
			font-size: 16px;
			outline: none;
		`;let o=s.el("button","afs-search-override-close");return o.innerHTML="\u2715",o.setAttribute("aria-label","Close search"),o.style.cssText=`
			padding: 8px 16px;
			background: transparent;
			border: none;
			font-size: 24px;
			cursor: pointer;
			color: var(--afs-text-color, #333);
		`,o.addEventListener("click",()=>{this.hideCustomSearchBox()}),t.appendChild(r),t.appendChild(o),e.appendChild(t),document.body.appendChild(e),this.replaceInput(r),n.customSearchBox=e,e},hideCustomSearchBox(){n.customSearchBox&&(n.customSearchBox.style.display="none",g.hideDropdown()),document.body.style.overflow=""},findSearchButtons(){let e=['button[aria-label*="search" i]','button[aria-label*="Search" i]','a[aria-label*="search" i]','a[aria-label*="Search" i]',"button.search","a.search",'button[class*="search"]','a[class*="search"]',"button[data-search]","a[data-search]","[data-search-toggle]","[data-search-trigger]",".search-icon",".search-button",'[id*="search" i]','[class*="search-icon" i]','[class*="search-button" i]','header button[type="button"]:has(svg[class*="search"])','header a:has(svg[class*="search"])',".header__icon--search",".site-header__search"],t=[];return e.forEach(r=>{try{document.querySelectorAll(r).forEach(i=>{var c,l;let a=((c=i.textContent)==null?void 0:c.toLowerCase())||"",d=((l=i.getAttribute("aria-label"))==null?void 0:l.toLowerCase())||"";(i.querySelector('svg[class*="search"], svg[aria-label*="search" i]')||a.includes("search")||d.includes("search"))&&t.push(i)})}catch(o){}}),t},findPredictiveSearchContainers(){let e=["[data-predictive-search]",'[id*="predictive" i]','[class*="predictive" i]','[class*="search-results" i]','[class*="search-dropdown" i]','[class*="search-suggestions" i]',".predictive-search",".search-results",".search-dropdown",".search-suggestions","[data-search-results]","[data-search-dropdown]",'[id*="Search" i]','[class*="Search" i]'],t=[];return e.forEach(r=>{try{document.querySelectorAll(r).forEach(i=>{!i.classList.contains("afs-search-container")&&!i.classList.contains("afs-search-dropdown")&&t.push(i)})}catch(o){}}),t},overrideSearchButton(e){n.searchButtons.has(e)||(this.removeInlineHandlers(e),e.addEventListener("click",t=>{t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation();let r=document.querySelector('input[name="q"], input[name="search"], input[type="search"]');r&&r.focus()},!0),n.searchButtons.add(e),p.debug("Removed inline handlers and added capture-phase listener to search button",{button:e}))},overrideSearchContainers(){this.findPredictiveSearchContainers().forEach(t=>{n.overriddenContainers.has(t)||(this.removeInlineHandlers(t),t.addEventListener("click",r=>{r.stopImmediatePropagation()},!0),t.setAttribute("data-afs-handled","true"),n.overriddenContainers.add(t),p.debug("Removed inline handlers and added capture-phase listeners to search container",{container:t}))})},removeInlineHandlers(e){["onclick","onsubmit","onfocus","onblur","oninput","onchange","onkeydown","onkeyup"].forEach(r=>{e.hasAttribute(r)&&e.removeAttribute(r);try{e[r]=null}catch(o){}})},replaceInput(e){if(n.replacedInputs.has(e))return;this.removeInlineHandlers(e);let t=e,r=g.setupInputContainer(t);n.container=r;let o=r.querySelector(".afs-search-dropdown");o||(o=g.createDropdown(),r.appendChild(o)),n.dropdown=o,o.addEventListener("click",f.handleClick);let i=t.closest("form");i&&!i.hasAttribute("data-afs-form-handled")&&(this.removeInlineHandlers(i),i.addEventListener("submit",a=>{a.preventDefault(),a.stopPropagation(),a.stopImmediatePropagation();let d=t.value.trim();d&&(window.location.href=`/search?q=${encodeURIComponent(d)}`)},!0),i.setAttribute("data-afs-form-handled","true")),t.addEventListener("input",a=>{a.stopImmediatePropagation(),f.handleInput(a)},!0),t.addEventListener("focus",a=>{a.stopImmediatePropagation(),f.handleFocus(a)},!0),t.addEventListener("blur",a=>{f.handleBlur(a)},!0),t.addEventListener("keydown",a=>{a.stopImmediatePropagation(),f.handleKeyDown(a)},!0),t.setAttribute("data-afs-search","true"),n.replacedInputs.add(t)},isFilterSectionInput(e){return!!(e.classList.contains("afs-filter-group__search-input")||e.closest("[data-afs-container]")||e.closest(".afs-filter-group")||e.name&&e.name.startsWith("afs-search-"))},isShopifySearchInput(e){if(e.name==="q"||e.name==="search")return!0;let t=e.closest("form");if(t){let r=t.getAttribute("action");if(r&&(r.includes("/search")||r.includes("search"))&&(e.type==="search"||e.type==="text"||!e.type))return!0}return!!(e.classList.contains("search__input")||e.hasAttribute("data-search-input"))},overrideSearchButtons(){this.findSearchButtons().forEach(t=>{this.overrideSearchButton(t)})},isElementVisible(e){if(!e)return!1;let t=window.getComputedStyle(e);if(t.display==="none"||t.visibility==="hidden"||t.opacity==="0")return!1;let r=e.getBoundingClientRect();if(r.width===0&&r.height===0)return!1;let o=r.top<window.innerHeight&&r.bottom>0&&r.left<window.innerWidth&&r.right>0,i=e.parentElement;for(;i&&i!==document.body;){let a=window.getComputedStyle(i);if(a.display==="none"||a.visibility==="hidden")return!1;i=i.parentElement}return o},observeInputForVisibility(e){n.observedInputs.has(e)||(n.visibilityObserver||(n.visibilityObserver=new IntersectionObserver(t=>{t.forEach(r=>{var i;let o=r.target;r.isIntersecting&&r.intersectionRatio>0&&this.isElementVisible(o)&&this.isShopifySearchInput(o)&&!n.replacedInputs.has(o)&&!this.isFilterSectionInput(o)&&(p.debug("Search input became visible, initializing search",{name:o.name,type:o.type}),this.replaceInput(o),(i=n.visibilityObserver)==null||i.unobserve(o),n.observedInputs.delete(o))})},{threshold:.01,rootMargin:"0px"})),n.visibilityObserver.observe(e),n.observedInputs.add(e))},findAndReplaceInputs(){document.querySelectorAll(n.config.searchInputSelector).forEach(t=>{if(!n.replacedInputs.has(t)){if(this.isFilterSectionInput(t)){p.debug("Skipping filter section input",{name:t.name,class:t.className});return}this.isShopifySearchInput(t)&&(this.isElementVisible(t)?(p.debug("Processing visible Shopify search input",{name:t.name,type:t.type}),this.replaceInput(t)):(p.debug("Shopify search input found but not visible, observing for visibility",{name:t.name}),this.observeInputForVisibility(t)))}})},init(e){let t={},r=this.readConfigFromDataAttributes();r&&(t={...t,...r}),e&&Object.keys(e).length>0&&(t={...t,...e}),n.config={...b,...t},this.overrideSearchButtons(),this.overrideSearchContainers(),this.findAndReplaceInputs(),new MutationObserver(()=>{this.overrideSearchButtons(),this.overrideSearchContainers(),this.findAndReplaceInputs()}).observe(document.body,{childList:!0,subtree:!0});let i=null,a=()=>{i&&clearTimeout(i),i=window.setTimeout(()=>{document.querySelectorAll(n.config.searchInputSelector).forEach(l=>{var h;!n.replacedInputs.has(l)&&!this.isFilterSectionInput(l)&&this.isShopifySearchInput(l)&&(this.isElementVisible(l)?(p.debug("Input became visible on scroll/resize, initializing",{name:l.name}),this.replaceInput(l),n.observedInputs.has(l)&&((h=n.visibilityObserver)==null||h.unobserve(l),n.observedInputs.delete(l))):n.observedInputs.has(l)||this.observeInputForVisibility(l))})},100)};window.addEventListener("scroll",a,{passive:!0}),window.addEventListener("resize",a,{passive:!0}),document.addEventListener("click",c=>{var l;if(n.isOpen&&n.container){let h=c.target;!n.container.contains(h)&&!((l=n.activeInput)!=null&&l.contains(h))&&g.hideDropdown()}if(n.customSearchBox&&n.customSearchBox.style.display==="block"){let h=c.target;if(!n.customSearchBox.contains(h)){let m=h.closest("button, a");(!m||!n.searchButtons.has(m))&&this.hideCustomSearchBox()}}}),document.addEventListener("keydown",c=>{c.key==="Escape"&&n.customSearchBox&&n.customSearchBox.style.display==="block"&&this.hideCustomSearchBox()});let d,u=()=>{n.activeInput&&n.container&&(g.updateContainerPosition(n.activeInput,n.container),n.isOpen&&g.positionDropdown(n.activeInput))};window.addEventListener("scroll",()=>{clearTimeout(d),d=setTimeout(u,10)},!0),window.addEventListener("resize",()=>{clearTimeout(d),d=setTimeout(u,10)}),p.info("Search module initialized",{config:n.config})}};if(typeof window!="undefined"){let e=window;e.AFSSearch={init:y.init.bind(y)}}var w=()=>{document.querySelector("[data-afs-search-container]")&&y.init()};document.readyState==="loading"?document.addEventListener("DOMContentLoaded",w):setTimeout(w,50);
