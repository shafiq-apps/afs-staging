"use strict";var g={enabled:!0,error:(e,t)=>{g.enabled&&console.error("[AFS]",e,t||"")},warn:(e,t)=>{g.enabled&&console.warn("[AFS]",e,t||"")},info:(e,t)=>{g.enabled&&console.info("[AFS]",e,t||"")},debug:(e,t)=>{g.enabled&&console.debug("[AFS]",e,t||"")},log:(e,...t)=>{g.enabled&&console.log(e,...t)},init:e=>{g.enabled=e!==!1,g.log("%cAdvanced Filter & Search initialized","color: #00c853;font-size: 20px;font-weight: bold;background: #0b1e13;padding: 10px 15px;border-radius: 6px;font-family: Arial, sans-serif;")}};var S={buttons:{quickAdd:"Quick Add",quickAddToCart:"Quick add to cart",quickView:"Quick view",addToCart:"Add to cart",soldOut:"Sold out",buyNow:"Buy it now",clear:"Clear",clearAll:"Clear All",close:"\u2715",closeFilters:"Close filters",toggleFilters:"Filters",filters:"Filters",previous:"Previous",next:"Next",apply:"Apply"},labels:{sortBy:"Sort by: ",appliedFilters:"Applied Filters:",search:"Search: ",price:"Price: ",collection:"Collection: ",productUnavailable:"Product unavailable",loading:"Loading...",loadingProduct:"Loading product..."},sortOptions:{bestSelling:"Best Selling",titleAsc:"Title (A-Z)",titleDesc:"Title (Z-A)",priceAsc:"Price (Low to High)",priceDesc:"Price (High to Low)",createdAsc:"Oldest First",createdDesc:"Newest First"},messages:{noProductsFound:"No products found",oneProductFound:"1 product found",productsFound:"products found",showingProducts:"Showing",pageOf:"Page",addedToCart:"Added to cart!",failedToLoad:"Failed to load",failedToLoadProducts:"Failed to load products",failedToLoadProduct:"Failed to load product",failedToAddToCart:"Failed to add product to cart. Please try again.",failedToProceedToCheckout:"Failed to proceed to checkout. Please try again.",failedToLoadProductModal:"Failed to load product. Please try again.",failedToLoadFilters:"Failed to load filters, continuing with empty filters",initializationFailed:"Initialization failed",loadFailed:"Load failed",unknownError:"Unknown error",checkConsole:"Check console for details."},placeholders:{searchProducts:"Search products...",searchFilter:"Search"}};var l={debounce:(e,t)=>{let r;return(...o)=>{r!==void 0&&clearTimeout(r),r=setTimeout(()=>e(...o),t)}},toLowerCase:e=>String(e||"").toLowerCase(),inputDisplayType:e=>l.equalsAny(l.toLowerCase(e==null?void 0:e.displayType),"radio")?"radio":"checkbox",isMultiSelect:e=>l.equalsAny(l.toLowerCase(e==null?void 0:e.selectionType),"multiple")||l.equalsAny(e==null?void 0:e.selectionType,"MULTIPLE"),split:e=>e?Array.isArray(e)?e.map(t=>String(t).trim()).filter(Boolean):String(e).split(",").map(t=>t.trim()).filter(Boolean):[],id:e=>{if(!e)return null;let t=e.productId||e.id||e.gid;return t&&String(t).split("/").pop()||null},str:e=>String(e||"").trim(),empty:e=>e?Array.isArray(e)?e.length===0:typeof e=="object"?Object.keys(e).length===0:!1:!0,el:(e,t,r={})=>{let o=document.createElement(e);return t&&(o.className=t),Object.entries(r).forEach(([a,i])=>o.setAttribute(a,i)),o},getAttrVal:(e,t)=>e==null?void 0:e.getAttribute(t),txt:(e,t)=>(e.textContent=t,e),clear:e=>{for(;e.firstChild;){let t=e.firstChild;t&&e.removeChild(t)}},frag:(e,t)=>{let r=document.createDocumentFragment();return e.forEach(o=>r.appendChild(t(o))),r},optimizeImageUrl:(e,t={})=>{if(!e||typeof e!="string")return"";let{width:r=500,height:o=r,quality:a=80,format:i="webp",crop:s=null}=t;if(!/(cdn\.shopify\.com|shopifycdn\.com)/i.test(e))return e;try{let u=new URL(e),d=new URLSearchParams(u.search);return d.delete("width"),d.delete("height"),d.delete("crop"),d.delete("format"),d.delete("quality"),d.set("width",String(r)),d.set("height",String(o)),s&&d.set("crop",s),a!==100&&d.set("quality",String(a)),!u.pathname.toLowerCase().endsWith(".gif")&&i&&d.set("format",i),`${u.origin}${u.pathname}?${d.toString()}`}catch(u){return e}},buildImageSrcset:(e,t=[200,300,500])=>e?t.map(r=>`${l.optimizeImageUrl(e,{width:r,format:"webp",quality:r<=200?75:r<=300?80:85})} ${r}w`).join(", "):"",formatMoney:(e,t,r="")=>{if(isNaN(Number(e)))return"";let o=parseFloat(String(e))/100;if(!t||typeof t!="string")return`${r||""}${o.toFixed(2)}`;let a=o.toFixed(2);return t.includes("{{amount_no_decimals}}")?(a=Math.round(o).toString(),t.replace("{{amount_no_decimals}}",a)):t.includes("{{amount_with_comma_separator}}")?(a=o.toFixed(2).replace(".",","),t.replace("{{amount_with_comma_separator}}",a)):t.includes("{{amount_no_decimals_with_comma_separator}}")?(a=Math.round(o).toString(),t.replace("{{amount_no_decimals_with_comma_separator}}",a)):t.includes("{{amount_with_apostrophe_separator}}")?(a=o.toFixed(2).replace(".","'"),t.replace("{{amount_with_apostrophe_separator}}",a)):t.replace("{{amount}}",a)},equals:(e,t)=>e===t?!0:e==null||t===null||t===void 0?!1:(Array.isArray(e)&&(e=e.join(",")),Array.isArray(t)&&(t=t.join(",")),typeof e=="string"&&typeof t=="string"?e.trim().toLowerCase()===t.trim().toLowerCase():typeof e=="number"&&typeof t=="number"||typeof e=="boolean"&&typeof t=="boolean"?e===t:String(e).trim().toLowerCase()===String(t).trim().toLowerCase()),equalsAny:(e,...t)=>e==null?!1:t.some(r=>l.equals(e,r)),isVendorKey:e=>l.equalsAny(e,"vendor","vendors"),isProductTypeKey:e=>l.equalsAny(e,"productType","productTypes"),isTagKey:e=>l.equalsAny(e,"tag","tags"),isCollectionKey:e=>l.equalsAny(e,"collection","collections"),isPriceRangeKey:e=>l.equalsAny(e,"priceRange","price"),isBestSelling:e=>l.equalsAny(e,"best-selling","bestselling"),isCollectionOptionType:e=>l.equals(e,"Collection"),isPriceRangeOptionType:e=>l.equals(e,"priceRange")};var b={apiBaseUrl:"https://fstaging.digitalcoo.com/storefront",shop:null,moneyFormat:null,currency:null,moneyWithCurrencyFormat:null,searchInputSelector:'input[name="q"], input[name="search"], input[type="search"][name*="q"], input[type="search"][name*="search"], .search__input, form[action*="/search"] input[type="search"], form[action*="/search"] input[name*="q"]',minQueryLength:2,debounceMs:300,maxSuggestions:5,maxProducts:6,showSuggestions:!0,showProducts:!0,enableKeyboardNav:!0,debug:!1},n={config:b,activeInput:null,dropdown:null,container:null,currentQuery:"",isOpen:!1,selectedIndex:-1,searchResults:null,isLoading:!1,abortController:null,replacedInputs:new Set,inputContainers:new Map,overriddenContainers:new Set,searchButtons:new Set,customSearchBox:null,visibilityObserver:null,observedInputs:new Set},p={createContainer(e){let t=l.el("div","afs-search-container");t.style.position="absolute",t.style.display="block";let r=e.getBoundingClientRect(),o=r.width,a=280,i=o<a?a:o,s=window.pageYOffset||document.documentElement.scrollTop,c=window.pageXOffset||document.documentElement.scrollLeft;return t.style.top=`${r.bottom+s}px`,t.style.left=`${r.left+c}px`,t.style.width=`${i}px`,t.style.minWidth=`${a}px`,t.style.zIndex="999999",t},createDropdown(){let e=l.el("div","afs-search-dropdown");return e.setAttribute("role","listbox"),e.setAttribute("aria-label","Search results"),e},setupInputContainer(e){if(n.inputContainers.has(e)){let a=n.inputContainers.get(e);return this.updateContainerPosition(e,a),a}let t=this.createContainer(e);document.body.appendChild(t);let r=this.createDropdown();return t.appendChild(r),n.inputContainers.set(e,t),new ResizeObserver(()=>{this.updateContainerPosition(e,t),n.isOpen&&n.activeInput===e&&this.positionDropdown(e)}).observe(e),t},updateContainerPosition(e,t){let r=e.getBoundingClientRect(),o=r.width,a=280,i=o<a?a:o,s=window.pageYOffset||document.documentElement.scrollTop,c=window.pageXOffset||document.documentElement.scrollLeft;t.style.top=`${r.bottom+s}px`,t.style.left=`${r.left+c}px`,t.style.width=`${i}px`,t.style.minWidth=`${a}px`},createSuggestionItem(e,t){let r=l.el("a","afs-search-dropdown__suggestion",{href:`/search?q=${encodeURIComponent(e)}`,role:"option","data-index":String(t),"data-type":"suggestion",tabindex:"-1"}),o=l.el("span","afs-search-dropdown__suggestion-icon");o.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.35-4.35"/></svg>';let a=l.el("span","afs-search-dropdown__suggestion-text");return a.textContent=e,r.appendChild(o),r.appendChild(a),r},createProductItem(e,t){var c,u;let r=e.handle||"",o=r?`/products/${r}`:"#",a=l.el("a","afs-search-dropdown__product",{href:o,role:"option","data-index":String(t),"data-handle":r,tabindex:"-1"});if(r||a.addEventListener("click",d=>{d.preventDefault(),g.warn("Product item clicked but no handle available",{product:e})}),e.imageUrl||e.featuredImage){let d=l.el("div","afs-search-dropdown__product-image"),h=l.el("img","",{alt:e.title||"",loading:"lazy",decoding:"async"}),y=((c=e.featuredImage)==null?void 0:c.url)||((u=e.featuredImage)==null?void 0:u.urlFallback)||e.imageUrl||"";y&&(h.src=y),d.appendChild(h),a.appendChild(d)}let i=l.el("div","afs-search-dropdown__product-info"),s=l.el("div","afs-search-dropdown__product-title");if(s.textContent=e.title||"",i.appendChild(s),e.vendor){let d=l.el("div","afs-search-dropdown__product-vendor");d.textContent=e.vendor,i.appendChild(d)}if(e.minPrice!==void 0){let d=l.el("div","afs-search-dropdown__product-price"),h=parseFloat(String(e.minPrice||0))*100,y=parseFloat(String(e.maxPrice||0))*100,w=n.config.moneyFormat||"{{amount}}",I=n.config.currency||"",T=l.formatMoney(h,w,I),C=h===y?T:`from ${T}`;d.textContent=C,i.appendChild(d)}return a.appendChild(i),a},createDidYouMeanItem(e){let t=l.el("div","afs-search-dropdown__did-you-mean",{role:"option","data-type":"did-you-mean",tabindex:"-1"}),r=l.el("span","afs-search-dropdown__did-you-mean-text");return r.innerHTML=`Did you mean <strong>${e}</strong>?`,t.appendChild(r),t},createEmptyState(e){let t=l.el("div","afs-search-dropdown__empty",{role:"option"});return t.textContent=e,t},createLoadingState(){let e=l.el("div","afs-search-dropdown__loading",{role:"option"});return e.innerHTML=`
			<div class="afs-search-dropdown__loading-spinner"></div>
			<span>${S.labels.loading}</span>
		`,e},renderDropdown(e,t,r=!1){var i;if(!n.dropdown)return;if(n.dropdown.innerHTML="",n.selectedIndex=-1,n.isLoading){n.dropdown.appendChild(this.createLoadingState());return}if(!t&&r){let s=this.createEmptyState("Start typing to search...");n.dropdown.appendChild(s);return}if(!e)return;let o=document.createDocumentFragment(),a=0;if(e.didYouMean&&e.zeroResults){let s=this.createDidYouMeanItem(e.didYouMean);s.setAttribute("data-index",String(a)),o.appendChild(s),a++}if(n.config.showSuggestions&&e.suggestions&&e.suggestions.length>0){let s=l.el("div","afs-search-dropdown__header");s.textContent="Suggestions",o.appendChild(s),e.suggestions.slice(0,n.config.maxSuggestions).forEach(c=>{let u=this.createSuggestionItem(c,a);o.appendChild(u),a++})}if(n.config.showProducts&&e.products&&e.products.length>0){let s=l.el("div","afs-search-dropdown__header");if(s.textContent=`Products (${((i=e.pagination)==null?void 0:i.total)||e.products.length})`,o.appendChild(s),e.products.slice(0,n.config.maxProducts).forEach(c=>{let u=this.createProductItem(c,a);o.appendChild(u),a++}),e.pagination&&e.pagination.total>n.config.maxProducts){let c=l.el("a","afs-search-dropdown__view-all",{href:`/search?q=${encodeURIComponent(t)}`,role:"option"});c.textContent=`View all ${e.pagination.total} results`,c.setAttribute("data-index",String(a)),o.appendChild(c),a++}}e.zeroResults&&(!e.suggestions||e.suggestions.length===0)&&(!e.products||e.products.length===0)&&o.appendChild(this.createEmptyState("No products found. Try adjusting your search terms.")),n.dropdown.appendChild(o)},positionDropdown(e){!n.dropdown||!n.container||(this.updateContainerPosition(e,n.container),n.dropdown.style.position="absolute",n.dropdown.style.top="100%",n.dropdown.style.left="0",n.dropdown.style.width="100%",n.dropdown.style.maxHeight="400px",n.dropdown.style.overflowY="auto",n.dropdown.style.zIndex="999999",n.dropdown.style.marginTop="4px")},showDropdown(){!n.dropdown||!n.activeInput||(n.container||(n.container=this.setupInputContainer(n.activeInput),n.dropdown=n.container.querySelector(".afs-search-dropdown"),n.dropdown||(n.dropdown=this.createDropdown(),n.container.appendChild(n.dropdown))),n.isOpen=!0,n.dropdown.classList.add("afs-search-dropdown--visible"),n.dropdown.setAttribute("aria-expanded","true"),this.positionDropdown(n.activeInput))},hideDropdown(){n.dropdown&&(n.isOpen=!1,n.selectedIndex=-1,n.dropdown.classList.remove("afs-search-dropdown--visible"),n.dropdown.setAttribute("aria-expanded","false"))},highlightItem(e){if(!n.dropdown)return;n.dropdown.querySelectorAll('[role="option"][data-index]').forEach((r,o)=>{o===e?(r.classList.add("afs-search-dropdown__item--selected"),r.scrollIntoView({block:"nearest",behavior:"smooth"})):r.classList.remove("afs-search-dropdown__item--selected")}),n.selectedIndex=e},getSelectedItem(){return!n.dropdown||n.selectedIndex<0?null:n.dropdown.querySelectorAll('[role="option"][data-index]')[n.selectedIndex]||null}},x={async search(e){let t=n.config.shop,r=n.config.apiBaseUrl;if(!t||!r)return g.error("Search API: shop or apiBaseUrl not configured",{hasShop:!!t,hasApiBaseUrl:!!r}),null;n.abortController&&n.abortController.abort(),n.abortController=new AbortController;let o=new URLSearchParams;o.set("shop",t),o.set("q",e),o.set("suggestions","true"),o.set("autocomplete","true"),o.set("limit",String(n.config.maxProducts));let a=`${r}/search?${o}`;try{n.isLoading=!0,p.renderDropdown(null,e);let i=await fetch(a,{signal:n.abortController.signal,headers:{Accept:"application/json"}});if(!i.ok)throw new Error(`HTTP ${i.status}: ${i.statusText}`);let s=await i.json();return!s.success||!s.data?(g.error("Invalid search response",{data:s}),null):s.data}catch(i){return i.name==="AbortError"?(g.debug("Search request aborted"),null):(g.error("Search API error",{error:i.message,query:e}),null)}finally{n.isLoading=!1}}},f={debouncedSearch:l.debounce(async e=>{if(e.length<n.config.minQueryLength){n.searchResults=null,p.hideDropdown();return}n.activeInput&&!n.inputContainers.has(n.activeInput)&&m.replaceInput(n.activeInput),n.currentQuery=e;let t=await x.search(e);n.searchResults=t,t!==null?(p.renderDropdown(t,e),p.showDropdown()):p.hideDropdown()},b.debounceMs),handleInput(e){let t=e.target,r=t.value.trim();n.activeInput=t,f.debouncedSearch(r)},handleFocus(e){let t=e.target;n.activeInput=t,n.inputContainers.has(t)?(n.container=n.inputContainers.get(t),n.dropdown=n.container.querySelector(".afs-search-dropdown")):m.replaceInput(t);let r=t.value.trim();r.length>=n.config.minQueryLength&&n.searchResults?(p.renderDropdown(n.searchResults,r),p.showDropdown()):r.length>0?f.debouncedSearch(r):(p.renderDropdown(null,"",!0),p.showDropdown())},handleBlur(e){setTimeout(()=>{var t,r;!((t=n.dropdown)!=null&&t.matches(":hover"))&&!((r=n.activeInput)!=null&&r.matches(":focus"))&&p.hideDropdown()},200)},handleKeyDown(e){var o,a,i,s;if(!n.isOpen||!n.dropdown)return;let r=n.dropdown.querySelectorAll('[role="option"][data-index]').length;switch(e.key){case"ArrowDown":e.preventDefault(),n.selectedIndex=Math.min(n.selectedIndex+1,r-1),p.highlightItem(n.selectedIndex);break;case"ArrowUp":e.preventDefault(),n.selectedIndex=Math.max(n.selectedIndex-1,-1),n.selectedIndex>=0?p.highlightItem(n.selectedIndex):(o=n.activeInput)==null||o.focus();break;case"Enter":e.preventDefault();let c=p.getSelectedItem();if(c)if(c.tagName==="A")window.location.href=c.href;else if(c.getAttribute("data-type")==="did-you-mean"){let u=(a=n.searchResults)==null?void 0:a.didYouMean;u&&n.activeInput&&(n.activeInput.value=u,f.debouncedSearch(u))}else{let u=(i=c.querySelector(".afs-search-dropdown__suggestion-text"))==null?void 0:i.textContent;u&&n.activeInput&&(n.activeInput.value=u,f.debouncedSearch(u))}else if(n.activeInput){let u=n.activeInput.value.trim();u&&(window.location.href=`/search?q=${encodeURIComponent(u)}`)}break;case"Escape":e.preventDefault(),p.hideDropdown(),(s=n.activeInput)==null||s.blur();break}},handleClick(e){var a,i,s;let r=e.target.closest('[role="option"]');if(!r)return;let o=r.getAttribute("data-type");if(o==="did-you-mean"){let c=(a=n.searchResults)==null?void 0:a.didYouMean;c&&n.activeInput&&(n.activeInput.value=c,f.debouncedSearch(c)),e.preventDefault();return}if(o==="suggestion"){let c=((i=r.querySelector(".afs-search-dropdown__suggestion-text"))==null?void 0:i.textContent)||r.textContent||"";c&&n.activeInput&&(n.activeInput.value=c),p.hideDropdown(),n.customSearchBox&&m.hideCustomSearchBox(),window.location.href=`/search?q=${encodeURIComponent(c)}`,e.preventDefault();return}if(r.tagName==="A"){if(r.getAttribute("data-handle")){p.hideDropdown(),n.customSearchBox&&m.hideCustomSearchBox();return}if(r.getAttribute("href")){p.hideDropdown(),n.customSearchBox&&m.hideCustomSearchBox();return}e.preventDefault(),g.warn("Link clicked but no navigation target available");return}else{let c=(s=r.querySelector(".afs-search-dropdown__suggestion-text"))==null?void 0:s.textContent;c&&n.activeInput&&(n.activeInput.value=c,f.debouncedSearch(c)),e.preventDefault()}}},m={readConfigFromDataAttributes(){let e=document.querySelector("[data-afs-search-container]");if(!e)return null;let t={};if(e.dataset.afsSearchShop&&(t.shop=e.dataset.afsSearchShop),e.dataset.afsSearchApiBaseUrl&&(t.apiBaseUrl=e.dataset.afsSearchApiBaseUrl),e.dataset.afsSearchMoneyFormat&&(t.moneyFormat=e.dataset.afsSearchMoneyFormat),e.dataset.afsSearchCurrency&&(t.currency=e.dataset.afsSearchCurrency),e.dataset.afsSearchMoneyWithCurrencyFormat&&(t.moneyWithCurrencyFormat=e.dataset.afsSearchMoneyWithCurrencyFormat),e.dataset.afsSearchDebug!==void 0){let r=e.dataset.afsSearchDebug;t.debug=r==="true"||r==="1"}if(e.dataset.afsSearchMinQueryLength){let r=parseInt(e.dataset.afsSearchMinQueryLength,10);!isNaN(r)&&r>0&&(t.minQueryLength=r)}if(e.dataset.afsSearchDebounceMs){let r=parseInt(e.dataset.afsSearchDebounceMs,10);!isNaN(r)&&r>=0&&(t.debounceMs=r)}if(e.dataset.afsSearchMaxSuggestions){let r=parseInt(e.dataset.afsSearchMaxSuggestions,10);!isNaN(r)&&r>0&&(t.maxSuggestions=r)}if(e.dataset.afsSearchMaxProducts){let r=parseInt(e.dataset.afsSearchMaxProducts,10);!isNaN(r)&&r>0&&(t.maxProducts=r)}if(e.dataset.afsSearchShowSuggestions!==void 0){let r=e.dataset.afsSearchShowSuggestions;t.showSuggestions=r==="true"||r==="1"}if(e.dataset.afsSearchShowProducts!==void 0){let r=e.dataset.afsSearchShowProducts;t.showProducts=r==="true"||r==="1"}if(e.dataset.afsSearchEnableKeyboardNav!==void 0){let r=e.dataset.afsSearchEnableKeyboardNav;t.enableKeyboardNav=r==="true"||r==="1"}return e.dataset.afsSearchInputSelector&&(t.searchInputSelector=e.dataset.afsSearchInputSelector),Object.keys(t).length>0?t:null},createCustomSearchBox(){if(n.customSearchBox)return n.customSearchBox;let e=l.el("div","afs-search-override-box");e.style.cssText=`
			position: fixed;
			top: 0;
			left: 0;
			right: 0;
			background: var(--afs-bg-color, #fff);
			border-bottom: 1px solid var(--afs-border-color, #e0e0e0);
			z-index: 999998;
			padding: 16px;
			box-shadow: 0 2px 8px rgba(0,0,0,0.1);
			display: none;
		`;let t=l.el("form","afs-search-override-form");t.style.cssText=`
			display: flex;
			align-items: center;
			gap: 12px;
			max-width: 1200px;
			margin: 0 auto;
		`;let r=l.el("input","afs-search-override-input");r.type="search",r.name="q",r.placeholder="Search products...",r.autocomplete="off",r.style.cssText=`
			flex: 1;
			padding: 12px 16px;
			border: 1px solid var(--afs-border-color, #e0e0e0);
			border-radius: 4px;
			font-size: 16px;
			outline: none;
		`;let o=l.el("button","afs-search-override-close");return o.innerHTML="\u2715",o.setAttribute("aria-label","Close search"),o.style.cssText=`
			padding: 8px 16px;
			background: transparent;
			border: none;
			font-size: 24px;
			cursor: pointer;
			color: var(--afs-text-color, #333);
		`,o.addEventListener("click",()=>{this.hideCustomSearchBox()}),t.appendChild(r),t.appendChild(o),e.appendChild(t),document.body.appendChild(e),this.replaceInput(r),n.customSearchBox=e,e},hideCustomSearchBox(){n.customSearchBox&&(n.customSearchBox.style.display="none",p.hideDropdown()),document.body.style.overflow=""},findSearchButtons(){let e=['button[aria-label*="search" i]','button[aria-label*="Search" i]','a[aria-label*="search" i]','a[aria-label*="Search" i]',"button.search","a.search",'button[class*="search"]','a[class*="search"]',"button[data-search]","a[data-search]","[data-search-toggle]","[data-search-trigger]",".search-icon",".search-button",'[id*="search" i]','[class*="search-icon" i]','[class*="search-button" i]','header button[type="button"]:has(svg[class*="search"])','header a:has(svg[class*="search"])',".header__icon--search",".site-header__search"],t=[];return e.forEach(r=>{try{document.querySelectorAll(r).forEach(a=>{var u,d;let i=((u=a.textContent)==null?void 0:u.toLowerCase())||"",s=((d=a.getAttribute("aria-label"))==null?void 0:d.toLowerCase())||"";(a.querySelector('svg[class*="search"], svg[aria-label*="search" i]')||i.includes("search")||s.includes("search"))&&t.push(a)})}catch(o){}}),t},findPredictiveSearchContainers(){let e=["[data-predictive-search]",'[id*="predictive" i]','[class*="predictive" i]','[class*="search-results" i]','[class*="search-dropdown" i]','[class*="search-suggestions" i]',".predictive-search",".search-results",".search-dropdown",".search-suggestions","[data-search-results]","[data-search-dropdown]",'[id*="Search" i]','[class*="Search" i]'],t=[];return e.forEach(r=>{try{document.querySelectorAll(r).forEach(a=>{!a.classList.contains("afs-search-container")&&!a.classList.contains("afs-search-dropdown")&&t.push(a)})}catch(o){}}),t},overrideSearchButton(e){n.searchButtons.has(e)||(this.removeInlineHandlers(e),e.addEventListener("click",t=>{t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation();let r=document.querySelector('input[name="q"], input[name="search"], input[type="search"]');r&&r.focus()},!0),n.searchButtons.add(e),g.debug("Removed inline handlers and added capture-phase listener to search button",{button:e}))},overrideSearchContainers(){this.findPredictiveSearchContainers().forEach(t=>{n.overriddenContainers.has(t)||(this.removeInlineHandlers(t),t.addEventListener("click",r=>{r.stopImmediatePropagation()},!0),t.setAttribute("data-afs-handled","true"),n.overriddenContainers.add(t),g.debug("Removed inline handlers and added capture-phase listeners to search container",{container:t}))})},removeInlineHandlers(e){["onclick","onsubmit","onfocus","onblur","oninput","onchange","onkeydown","onkeyup"].forEach(r=>{e.hasAttribute(r)&&e.removeAttribute(r);try{e[r]=null}catch(o){}})},replaceInput(e){if(n.replacedInputs.has(e))return;this.removeInlineHandlers(e);let t=e,r=p.setupInputContainer(t);n.container=r;let o=r.querySelector(".afs-search-dropdown");o||(o=p.createDropdown(),r.appendChild(o)),n.dropdown=o,o.addEventListener("click",f.handleClick);let a=t.closest("form");a&&!a.hasAttribute("data-afs-form-handled")&&(this.removeInlineHandlers(a),a.addEventListener("submit",i=>{i.preventDefault(),i.stopPropagation(),i.stopImmediatePropagation();let s=t.value.trim();s&&(window.location.href=`/search?q=${encodeURIComponent(s)}`)},!0),a.setAttribute("data-afs-form-handled","true")),t.addEventListener("input",i=>{i.stopImmediatePropagation(),f.handleInput(i)},!0),t.addEventListener("focus",i=>{i.stopImmediatePropagation(),f.handleFocus(i)},!0),t.addEventListener("blur",i=>{f.handleBlur(i)},!0),t.addEventListener("keydown",i=>{i.stopImmediatePropagation(),f.handleKeyDown(i)},!0),t.setAttribute("data-afs-search","true"),n.replacedInputs.add(t)},isFilterSectionInput(e){return!!(e.classList.contains("afs-filter-group__search-input")||e.closest("[data-afs-container]")||e.closest(".afs-filter-group")||e.name&&e.name.startsWith("afs-search-"))},isShopifySearchInput(e){if(e.name==="q"||e.name==="search")return!0;let t=e.closest("form");if(t){let r=t.getAttribute("action");if(r&&(r.includes("/search")||r.includes("search"))&&(e.type==="search"||e.type==="text"||!e.type))return!0}return!!(e.classList.contains("search__input")||e.hasAttribute("data-search-input"))},overrideSearchButtons(){this.findSearchButtons().forEach(t=>{this.overrideSearchButton(t)})},isElementVisible(e){if(!e)return!1;let t=window.getComputedStyle(e);if(t.display==="none"||t.visibility==="hidden"||t.opacity==="0")return!1;let r=e.getBoundingClientRect();if(r.width===0&&r.height===0)return!1;let o=r.top<window.innerHeight&&r.bottom>0&&r.left<window.innerWidth&&r.right>0,a=e.parentElement;for(;a&&a!==document.body;){let i=window.getComputedStyle(a);if(i.display==="none"||i.visibility==="hidden")return!1;a=a.parentElement}return o},observeInputForVisibility(e){n.observedInputs.has(e)||(n.visibilityObserver||(n.visibilityObserver=new IntersectionObserver(t=>{t.forEach(r=>{var a;let o=r.target;r.isIntersecting&&r.intersectionRatio>0&&this.isElementVisible(o)&&this.isShopifySearchInput(o)&&!n.replacedInputs.has(o)&&!this.isFilterSectionInput(o)&&(g.debug("Search input became visible, initializing search",{name:o.name,type:o.type}),this.replaceInput(o),(a=n.visibilityObserver)==null||a.unobserve(o),n.observedInputs.delete(o))})},{threshold:.01,rootMargin:"0px"})),n.visibilityObserver.observe(e),n.observedInputs.add(e))},findAndReplaceInputs(){document.querySelectorAll(n.config.searchInputSelector).forEach(t=>{if(!n.replacedInputs.has(t)){if(this.isFilterSectionInput(t)){g.debug("Skipping filter section input",{name:t.name,class:t.className});return}this.isShopifySearchInput(t)&&(this.isElementVisible(t)?(g.debug("Processing visible Shopify search input",{name:t.name,type:t.type}),this.replaceInput(t)):(g.debug("Shopify search input found but not visible, observing for visibility",{name:t.name}),this.observeInputForVisibility(t)))}})},init(e){let t={},r=this.readConfigFromDataAttributes();r&&(t={...t,...r}),e&&Object.keys(e).length>0&&(t={...t,...e}),n.config={...b,...t},this.overrideSearchButtons(),this.overrideSearchContainers(),this.findAndReplaceInputs(),new MutationObserver(()=>{this.overrideSearchButtons(),this.overrideSearchContainers(),this.findAndReplaceInputs()}).observe(document.body,{childList:!0,subtree:!0});let a=null,i=()=>{a&&clearTimeout(a),a=window.setTimeout(()=>{document.querySelectorAll(n.config.searchInputSelector).forEach(d=>{var h;!n.replacedInputs.has(d)&&!this.isFilterSectionInput(d)&&this.isShopifySearchInput(d)&&(this.isElementVisible(d)?(g.debug("Input became visible on scroll/resize, initializing",{name:d.name}),this.replaceInput(d),n.observedInputs.has(d)&&((h=n.visibilityObserver)==null||h.unobserve(d),n.observedInputs.delete(d))):n.observedInputs.has(d)||this.observeInputForVisibility(d))})},100)};window.addEventListener("scroll",i,{passive:!0}),window.addEventListener("resize",i,{passive:!0}),document.addEventListener("click",u=>{var d;if(n.isOpen&&n.container){let h=u.target;!n.container.contains(h)&&!((d=n.activeInput)!=null&&d.contains(h))&&p.hideDropdown()}if(n.customSearchBox&&n.customSearchBox.style.display==="block"){let h=u.target;if(!n.customSearchBox.contains(h)){let y=h.closest("button, a");(!y||!n.searchButtons.has(y))&&this.hideCustomSearchBox()}}}),document.addEventListener("keydown",u=>{u.key==="Escape"&&n.customSearchBox&&n.customSearchBox.style.display==="block"&&this.hideCustomSearchBox()});let s,c=()=>{n.activeInput&&n.container&&(p.updateContainerPosition(n.activeInput,n.container),n.isOpen&&p.positionDropdown(n.activeInput))};window.addEventListener("scroll",()=>{clearTimeout(s),s=setTimeout(c,10)},!0),window.addEventListener("resize",()=>{clearTimeout(s),s=setTimeout(c,10)}),g.info("Search module initialized",{config:n.config})}};typeof window!="undefined"&&(window.AFSSearch={init:m.init.bind(m)});var v=()=>{document.querySelector("[data-afs-search-container]")&&m.init()};document.readyState==="loading"?document.addEventListener("DOMContentLoaded",v):setTimeout(v,50);
