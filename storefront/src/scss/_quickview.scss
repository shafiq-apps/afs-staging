/**
 * Advanced Filter Search - Quick View & Slider Styles
 * Product modal, quick view button, and image slider styles
 */

@use 'variables' as *;
@use 'components' as *;

shopify-list-context[type="image"] {
    display: contents;
}

.afs-product-modal {
    border: 0 !important;
    border-radius: $border-radius-sm;
    box-shadow: 0 25px 50px -12px var(--afs-shadow-color-strong);
    padding: 0 !important;
    outline: none !important;
    max-width: 70%;
    width: 90%;
    margin: auto;
    overflow: hidden;
    max-height: 90vh;
    background: transparent;
    -ms-overflow-style: none;
    scrollbar-width: none;

    &::-webkit-scrollbar {
        display: none;
    }

    &::backdrop {
        background-color: var(--afs-overlay-color-strong);
        backdrop-filter: blur(4px);
        -webkit-backdrop-filter: blur(4px);
    }

    &__container {
        overflow: hidden;
        padding: 0;
        position: relative;
        max-height: 90vh;
        display: flex;
        flex-direction: column;
    }

    &__close-container {
        display: grid;
        justify-content: end;
        justify-items: end;
        position: absolute;
        right: 0;
        top: 0;
        z-index: 1;
    }

    &__close {
        border: 1px solid var(--afs-border-color);
        border-radius: 0px;
        border-bottom-left-radius: $border-radius-sm; // because top right corner (modal has radius) has small radius _rounded
        cursor: pointer;
        height: 40px;
        width: 40px;
        background: var(--afs-bg-color);
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 20px;
        line-height: 1;
        transition: all $transition-base;
        color: var(--afs-text-color);
        padding: 0;
        margin: 0;

        &:hover {
            background: var(--afs-accent-color);
            color: var(--afs-text-color-inverse);
            border-color: var(--afs-accent-color);
        }

        svg {
            width: 18px;
        }
    }

    &__content {
        background-color: var(--afs-bg-color);
        border-radius: $border-radius-sm;
        width: 100%;
        overflow-y: auto;
        overflow-x: hidden;
        max-height: 90vh;
        border: 1px solid var(--afs-border-color);
        @include custom-scrollbar(8px, var(--afs-scrollbar-track), var(--afs-scrollbar-thumb));
    }

    &__layout {
        display: flex;
        flex-direction: column;
        overflow: hidden;
        padding: $spacing-md;
    }

    &__media {
        align-items: flex-start;
        display: flex;
        flex-direction: row;
        justify-content: flex-start;
        padding: 0;
        min-width: 400px;
        max-width: 50%;
        width: 100%;
        gap: 1rem;
        height: 600px;
        max-height: 600px;
        min-height: 600px;

        shopify-media {
            display: block;
            width: 100%;

            img {
                border-radius: $border-radius-sm;
                width: 100%;
                height: auto;
                display: block;
                object-fit: contain;
            }
        }
    }

    &__image-slider {
        flex: 1;
        width: 100%;
        overflow: hidden;
        position: relative;
    }

    &__image-grid {
        position: relative;
        width: 100%;
        overflow: hidden;
        min-height: 400px;
        display: flex;
        align-items: center;
        justify-content: center;
        background: var(--afs-bg-secondary);

        shopify-media {
            display: none;
            width: 100%;
            height: auto;
        }

        shopify-media img {
            width: auto;
            height: auto;
            max-width: 100%;
            max-height: 500px;
            object-fit: contain;
            object-position: center;
            display: block;
            margin: 0 auto;
            cursor: zoom-in;
            transition: transform $transition-slow;

            &:hover {
                transform: scale(1.1);
                cursor: zoom-out;
            }
        }
    }

    &__main-image-item {
        display: none !important;
        width: 100%;
        height: auto;
        display: flex;
        align-items: center;
        justify-content: center;

        &:first-child {
            display: flex !important;
        }

        &[style*="display: block"],
        &[style*="display: flex"] {
            display: flex !important;
        }
    }

    &__images {
        display: flex;
        flex-direction: column;
        gap: 0.5rem;
        overflow-x: hidden;
        overflow-y: auto;
        padding: 0 0.5rem;
        scroll-behavior: smooth;
        flex-shrink: 0;
        max-height: 500px;
        @include custom-scrollbar(4px, var(--afs-scrollbar-track), var(--afs-scrollbar-thumb));
    }

    &__image {
        flex: 0 0 80px;
        width: 80px;
        height: 80px;
        border: 2px solid transparent;
        border-radius: $border-radius-sm;
        cursor: pointer;
        overflow: hidden;
        transition: all $transition-base;
        opacity: 0.7;

        &:hover {
            opacity: 1;
            border-color: var(--afs-accent-color);
        }

        &--active {
            opacity: 1;
            border-color: var(--afs-accent-color);
        }

        shopify-media {
            display: block;
            width: 100%;
            height: 100%;

            img {
                width: 100%;
                height: 100%;
                object-fit: cover;
                display: block;
            }
        }
    }

    &__image-small {
        width: 100%;
        height: 100%;
    }

    &__details {
        background: var(--afs-bg-color);
        border-radius: $border-radius-sm;
        display: flex;
        flex-direction: column;
        gap: 1.5rem;
        padding: 0;
        padding-left: $spacing-lg;
        width: 100%;
    }

    &__header {
        display: grid;
        gap: 0.5rem;
    }

    &__vendor {
        opacity: 0.5;
        font-weight: $font-weight-bold;
        letter-spacing: 0.05em;
        text-transform: uppercase;
        font-size: $font-size-base;
        color: var(--afs-text-color);

        shopify-data {
            display: block;
        }
    }

    &__title {
        color: var(--afs-text-color);
        font-size: 2.5rem;
        font-weight: $font-weight-medium;
        line-height: 2.5rem;
        margin: 0;


        shopify-data {
            display: block;
        }
    }

    &__price-container {
        color: var(--afs-text-color);
        display: flex;
        gap: 0.5rem;
        font-weight: $font-weight-medium;
        font-size: 1rem;
        line-height: 1.75rem;

    }

    &__compare-price {
        text-decoration: line-through;
        opacity: 0.5;
    }

    &__description {
        display: flex;
        justify-content: space-between;

        &-text {
            font-weight: $font-weight-normal;
            letter-spacing: normal;
            color: var(--afs-text-color);
            font-size: 1.25rem;


            p {
                margin: 0.5rem 0;
            }

            shopify-data {
                display: block;
            }
        }
    }

    &__buttons {
        display: flex;
        flex-direction: column;
        gap: 1.4rem;
    }

    &__add-to-cart {
        display: flex;
        flex-direction: row;
        gap: $spacing-md;
    }

    &__incrementor {
        border: 1px solid var(--afs-border-color);
        display: flex;
        align-items: center;
        gap: $spacing-sm;
        border-radius: $border-radius-sm;
        width: fit-content;

        button {
            color: var(--afs-text-color);
            background: inherit;
            cursor: pointer;
            font-size: $font-size-md;
            width: 40px;
            height: 100%;
            border: none;
            padding: 0;
            box-shadow: none;

            svg {
                transform: translateY(2.5px) scale(0.45);
            }

            &:hover {
                background: var(--afs-bg-secondary);
            }
        }
    }

    &__count {
        font-size: 1.4rem;
        padding: 0 0.25rem;
        min-width: 20px;
        text-align: center;

    }

    &__add-button {
        @include button-base;
        background-color: var(--afs-accent-color);
        color: var(--afs-text-color-inverse);
        padding: $spacing-md $spacing-lg;
        font-size: $font-size-xl;
        font-weight: $font-weight-medium;
        width: 100%;
        border: none;
        cursor: pointer;

        transition: background-color $transition-slow, color $transition-slow;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: $spacing-md;
        user-select: none;
        border-radius: $border-radius-sm;

        &:disabled {
            opacity: 0.3;
        }

        &[disabled]:hover {
            cursor: not-allowed;
            opacity: 0.3;
            background-color: var(--afs-accent-color-hover);
        }
    }

    &__buy-button {
        background-color: var(--afs-bg-color);
        color: var(--afs-text-color);
        padding: $spacing-md $spacing-md;
        font-size: $font-size-xl;
        font-weight: $font-weight-medium;
        width: 100%;
        border: 2px solid var(--afs-border-color);
        cursor: pointer;

        transition: all $transition-slow, color $transition-slow;
        border-radius: $border-radius-sm;

        &:disabled {
            opacity: 0.3;
        }

        &:hover {
            color: var(--afs-text-color-inverse);
            background: var(--afs-accent-color);
            border-color: var(--afs-accent-color);
        }

        &[disabled]:hover {
            opacity: 0.3;
            cursor: not-allowed;
            background-color: var(--afs-bg-secondary);
        }
    }

    &__variant-selector {
        display: block;
        margin: 1rem 0;
    }

    &__option-group {
        display: flex;
        flex-direction: column;
        gap: $spacing-lg;
        margin-bottom: $spacing-md;
    }

    &__option-label {
        font-size: $font-size-md;
        font-weight: $font-weight-medium;
        color: var(--afs-text-color);

        user-select: none;
    }

    &__option-values {
        display: flex;
        gap: $spacing-md;
        flex-wrap: wrap;
    }

    &__option-value {
        padding: 0.8rem 1.2rem;
        border: 1px solid var(--afs-accent-color);
        background: var(--afs-bg-color);
        color: var(--afs-text-color);
        border-radius: $border-radius-sm;
        cursor: pointer;
        font-size: $font-size-base;
        font-weight: $font-weight-medium;
        transition: all $transition-base;

        user-select: none;

        &:hover:not(:disabled) {
            background: var(--afs-accent-color);
            color: var(--afs-text-color-inverse);
            opacity: 0.8;
        }

        &--selected {
            background: var(--afs-accent-color);
            color: var(--afs-text-color-inverse);
        }

        &--unavailable,
        &:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            position: relative;
            overflow: hidden; // Clip the diagonal line to button boundaries

            // Diagonal line from top-right edge to bottom-left edge
            // Always touches both corners regardless of button size
            &::after {
                content: '';
                position: absolute;
                // Cover the entire button area
                top: 0;
                right: 0;
                bottom: 0;
                left: 0;
                // Create diagonal line using linear gradient
                // This ensures it always goes from top-right to bottom-left corner
                background: linear-gradient(to bottom left,
                        transparent calc(50% - 1px),
                        var(--afs-text-color) calc(50% - 1px),
                        var(--afs-text-color) calc(50% + 1px),
                        transparent calc(50% + 1px));
                pointer-events: none;
                z-index: 1;
            }
        }
    }
}

.afs-slider {
    position: relative;
    width: 100%;
    height: 100%;
    display: flex;
    overflow: hidden;

    /* Thumbnail Positions */
    &[data-thumbnails-position="right"] {
        flex-direction: row;
        .afs-slider__thumbnails {
            padding: 0px $spacing-md;
            padding-right: 0px;
        }
    }

    &[data-thumbnails-position="left"] {
        flex-direction: row-reverse;
        .afs-slider__thumbnails {
            padding: 0px $spacing-md;
            padding-left: 0px;
        }
    }

    &[data-thumbnails-position="bottom"] {
        flex-direction: column;
        .afs-slider__thumbnails {
            padding: $spacing-md 0px;
        }
    }

    &[data-thumbnails-position="top"] {
        flex-direction: column-reverse;
        .afs-slider__thumbnails {
            padding: $spacing-md 0px;
            padding-top: 0px;
        }
    }

    /* Main Image Container */
    &__main {
        position: relative;
        flex: 1;
        overflow: hidden;
        display: flex;
        align-items: center;
        justify-content: center;
        min-height: 300px;
        max-height: 600px;
        height: 600px;
    }

    &__viewport {
        position: relative;
        width: 100%;
        height: 100%;
        max-height: 600px;
        display: flex;
        align-items: center;
        justify-content: center;
        overflow: hidden;
        cursor: zoom-in;
        border-radius: $border-radius-sm;

        // &--zoomable {
        //     // Zoom cursor handled in media query
        // }
    }

    /* Zoom Controls */
    &__zoom-controls {
        position: absolute;
        bottom: 12px;
        right: 12px;
        z-index: 10;
        opacity: 1;
        transition: opacity 0.3s ease;
        pointer-events: auto;
    }

    &__zoom-slider {
        width: 80px;
        height: 4px;
        -webkit-appearance: none;
        appearance: none;
        background: var(--afs-bg-secondary);
        border-radius: $border-radius-sm;
        outline: none;
        cursor: pointer;
        transition: all 0.2s ease;

        &:hover {
            background: var(--afs-accent-color);
        }

        // Webkit (Chrome, Safari, Edge)
        &::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 12px;
            height: 12px;
            background: rgba(255, 255, 255, 0.9);
            border-radius: $border-radius-full;
            cursor: pointer;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);
            transition: all 0.2s ease;

            &:hover {
                background: #fff;
                transform: scale(1.2);
                box-shadow: 0 2px 6px rgba(0, 0, 0, 0.4);
            }
        }

        // Firefox
        &::-moz-range-thumb {
            width: 12px;
            height: 12px;
            background: rgba(255, 255, 255, 0.9);
            border-radius: $border-radius-full;
            border: none;
            cursor: pointer;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);
            transition: all 0.2s ease;

            &:hover {
                background: #fff;
                transform: scale(1.2);
                box-shadow: 0 2px 6px rgba(0, 0, 0, 0.4);
            }
        }

        // Track styling for Firefox
        &::-moz-range-track {
            background: rgba(255, 255, 255, 0.3);
            border-radius: $border-radius-sm;
            height: 4px;
        }

        &:focus {
            outline: none;

            &::-webkit-slider-thumb {
                box-shadow: 0 0 0 3px rgba(255, 255, 255, 0.3);
            }

            &::-moz-range-thumb {
                box-shadow: 0 0 0 3px rgba(255, 255, 255, 0.3);
            }
        }

        &:active {
            &::-webkit-slider-thumb {
                transform: scale(1.3);
            }

            &::-moz-range-thumb {
                transform: scale(1.3);
            }
        }
    }

    &__image {
        display: none;
        width: 100%;
        height: 100%;
        object-fit: contain;
        transform-origin: top left;
        transition: transform 0.2s ease-out;
        position: relative;
        user-select: none;
        -webkit-user-drag: none;
        will-change: transform;

        &--active {
            display: block;
        }

        // Zoom states - use classes instead of inline styles
        &--zoomed {
            transition: transform 0.05s ease-out;
            // Use CSS custom properties for dynamic zoom values
            // These are set via JavaScript but controlled via CSS class
        }

        &--zoom-reset {
            transform: scale(1) translate(0, 0) !important;
            transition: transform 0.2s ease-out !important;
        }
    }

    /* Navigation Buttons */
    &__prev,
    &__next {
        position: absolute;
        top: 50%;
        transform: translateY(-50%);
        background: var(--afs-bg-secondary);
        color: var(--afs-text-color);
        border: 1px solid var(--afs-border-color);
        border-radius: $border-radius-full;
        width: 44px;
        height: 44px;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        z-index: $z-index-dropdown;
        transition: all $transition-base;
        padding: 0;

        &:hover {
            background: var(--afs-accent-color-hover);

            svg {
                color: var(--afs-text-color-inverse);
            }
        }

        svg {
            width: 24px;
            height: 24px;
            pointer-events: none;
            transition: all $transition-base;
        }
    }

    &__prev {
        left: $spacing-md;
    }

    &__next {
        right: $spacing-md;
    }

    /* Thumbnails Container */
    &__thumbnails {
        display: flex;
        gap: $spacing-md;
        overflow-x: auto;
        overflow-y: hidden;
        scrollbar-width: thin;
        scrollbar-color: rgba(0, 0, 0, 0.2) transparent;

        &::-webkit-scrollbar {
            height: 4px;
        }

        &::-webkit-scrollbar-track {
            background: transparent;
        }

        &::-webkit-scrollbar-thumb {
            background: rgba(0, 0, 0, 0.2);
            border-radius: $border-radius-sm;

            &:hover {
                background: rgba(0, 0, 0, 0.3);
            }
        }
    }

    /* Thumbnail Positions */
    &[data-thumbnails-position="left"] &__thumbnails,
    &[data-thumbnails-position="right"] &__thumbnails {
        flex-direction: column;
        width: 100px;
        min-width: 100px;
        max-width: 100px;
        overflow-x: hidden;
        overflow-y: auto;

        &::-webkit-scrollbar {
            width: 4px;
            height: auto;
        }
    }

    &[data-thumbnails-position="top"] &__thumbnails,
    &[data-thumbnails-position="bottom"] &__thumbnails {
        flex-direction: row;
        width: 100%;
        max-height: 120px;
    }

    /* Individual Thumbnail */
    &__thumbnail {
        flex-shrink: 0;
        cursor: pointer;
        border: 2px solid var(--afs-border-color);
        border-radius: $border-radius-sm;
        overflow: hidden;
        transition: all $transition-base;
        opacity: 0.9;
        outline: none;

        &:hover {
            opacity: 1;
            border-color: var(--afs-accent-color);
        }

        &--active {
            opacity: 1;
            border-color: var(--afs-accent-color);
        }

        img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            display: block;
            pointer-events: none;
        }
    }
}